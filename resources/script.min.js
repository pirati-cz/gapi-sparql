$(document).ready(function(){var l;function m(){this.addNode=function(w){o.push({id:w});t()};this.removeNode=function(A){var w=0;var z=r(A);while(w<y.length){if((y[w]["source"]==z)||(y[w]["target"]==z)){y.splice(w,1)}else{w++}}o.splice(v(A),1);t()};this.removeLink=function(z,A){for(var w=0;w<y.length;w++){if(y[w].source.id==z&&y[w].target.id==A){y.splice(w,1);break}}t()};this.removeallLinks=function(){y.splice(0,y.length);t()};this.removeAllNodes=function(){o.splice(0,y.length);t()};this.addLink=function(z,A,w){y.push({source:r(z),target:r(A),value:w});t()};var r=function(z){for(var w in o){if(o[w]["id"]===z){return o[w]}}};var v=function(z){for(var w=0;w<o.length;w++){if(o[w].id==z){return w}}};var x=$(window).width(),u=$(window).height();var s=d3.scale.category10();var p=d3.select("body").append("svg:svg").attr("width",x).attr("height",u).attr("id","svg").attr("pointer-events","all").attr("viewBox","0 0 "+x+" "+u).attr("perserveAspectRatio","xMinYMid").append("svg:g");var q=d3.layout.force();var o=q.nodes(),y=q.links();var t=function(){var A=p.selectAll("line").data(y,function(B){return B.source.id+"-"+B.target.id});A.enter().append("line").attr("id",function(B){return B.source.id+"-"+B.target.id}).attr("stroke-width",function(B){return B.value/10}).attr("class","link");A.append("title").text(function(B){return B.value});A.exit().remove();var z=p.selectAll("g.node").data(o,function(B){return B.id});var w=z.enter().append("g").attr("class","node").call(q.drag);w.append("svg:circle").attr("r",Math.floor((Math.random()*12)+6)).attr("id",function(B){return"Node;"+B.id}).attr("class","nodeStrokeClass").attr("fill",function(B){return s(B.id)});z.exit().remove();q.on("tick",function(){z.attr("transform",function(B){return"translate("+B.x+","+B.y+")"});A.attr("x1",function(B){return B.source.x}).attr("y1",function(B){return B.source.y}).attr("x2",function(B){return B.target.x}).attr("y2",function(B){return B.target.y})});q.gravity(0.01).charge(-40000).friction(0.001).linkDistance(function(B){return B.value*10}).size([x,u]).start()};t()}function g(){l=new m("#svgdiv");d()}g();function d(){$(".nodeStrokeClass").each(function(o){var p=this.parentNode;p.parentNode.appendChild(p)})}function c(){d3.select("svg").remove();g()}var b=[];var a=[];var j=[];var f=0;var i=setInterval(function(){if(b.length>300){clearInterval(i)}do{f=Math.floor((Math.random()*15000)+5000)}while(!$.inArray(f,b));l.addNode(f);b.push(f)},2);var k=0;var n=1;var h=300;var e=setInterval(function(){if(k+1>=h){clearInterval(e)}do{rand1=Math.floor((Math.random()*b.length)+0);rand2=Math.floor((Math.random()*b.length)+0);if(j[rand1]===undefined){j[rand1]=0}if(j[rand2]===undefined){j[rand2]=0}}while(!$.inArray(rand1+"-"+rand2,a)&&!$.inArray(rand2+"-"+rand1,a));if(rand1>0&&rand2>0){j[rand1]++;j[rand2]++;k++;l.addLink(b[rand1],b[rand2],Math.floor((Math.random()*50)+5));a.push(rand1+"-"+rand2);a.push(rand2+"-"+rand1);d();var p=j[rand1];if(p<=n){p="*"+j[rand1]+"*"}var o=j[rand2];if(o<=n){o="*"+j[rand2]+"*"}}},200)});